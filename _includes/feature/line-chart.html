{% comment %}

    Embed a line chart, https://www.chartjs.org/docs/latest/charts/line.html
    
    E.G. --> {% include feature/line-chart.html data="party_platforms_20th_century_all" topic="free America" %}

    Options for data value:
        sotu_20th_century
        sotu_20th_century_1900_1944
        sotu_20th_century_1948_2000
        party_platforms_1900_1944_all
        party_platforms_1900_1944_democratic
        party_platforms_1900_1944_republican
        party_platforms_1948_2000_all
        party_platforms_1948_2000_democratic
        party_platforms_1948_2000_republican
        party_platforms_20th_century_all
        party_platforms_20th_century_democratic
        party_platforms_20th_century_republican

{% endcomment %}

{% capture topicdata %}{{ include.data | append: '_topics' }}{% endcapture %}
{% capture documentdata %}{{ include.data | append: '_documents' }}{% endcapture %}
{% capture varName %}topic_{{ include.topic | slugify | replace: "-", "_" }}_data_{{ include.data | slugify | replace: "-", "_" }}{% endcapture %}

{%- assign chosentopics = site.data.topics[topicdata] | where: 'TopicName', include.topic -%}
{%- assign chosendocuments = site.data.topics[documentdata] -%}

<div class="text-center">
    <h4>Line Chart</h4>
    <p>{{ include.data | replace: '_', ' ' | replace: 'sotu', 'State of the Union' | remove: ' all' }} </p>
</div>

{%- for t in chosentopics -%}
<p class="text-center"><strong>{{ t.TopicName | capitalize }}:</strong> {{ t.Words }}</p>
{%- endfor -%}

<canvas id="{{ varName }}" class="py-5"></canvas>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.6.0/chart.min.js"></script>
<script>
var ctx = document.getElementById('{{ varName }}');
var presidents = [
    {%- for d in chosendocuments -%}
    {{ d.id | replace: "-", " " | jsonify }} {% unless forloop.last %},{% endunless %}
    {%- endfor -%}
]
var topic = [
    {%- for d in chosendocuments -%}
    {% for t in chosentopics -%}
    {{ d[t.Topic] | jsonify }}
    {%- endfor -%}
    {% unless forloop.last %},{% endunless %}
    {%- endfor -%}
]
var myChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: presidents,
        datasets: [{
            label: '{{ include.topic | capitalize }} Topic',
            data: topic,
            fill: false,
            borderColor: 'rgb(75, 192, 192)',
            tension: 0.1
        }]
    },
});
</script>